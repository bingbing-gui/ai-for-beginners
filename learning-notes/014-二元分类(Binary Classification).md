# 🎯 AI 系列第十四篇：二元分类(Binary Classification)

**#ai人工智能 #AI #机器学习 #分类**  

---

## 📌 分类与回归  

分类 (Classification) 和回归 (Regression) **同属于监督学习 (Supervised Learning)**，两者的 **训练、验证、评估流程相似**。  

📌 **主要区别**：
- **回归模型** 预测 **连续数值**（如房价、销量）。
- **分类模型** 预测 **类别**（如是否购买、是否患病）。
- 分类模型 **计算类别概率**，然后根据概率 **确定最终类别**。

---

## 1️⃣ 什么是二元分类？  

📌 **二元分类 (Binary Classification)** 指训练一个 **只能预测两种可能结果** 的模型。  
简单来说，就是判断 **"是" 还是 "否"**，本质上是在预测 **true 或 false**。  

📌 **二元分类的特点**：
- 训练数据通常包含：
  - **多个特征值 (x)**：描述数据的属性。
  - **一个目标值 (y)**：只有 **0 或 1**（如 **某人是否患病**）。  

### 📊 示例：用血糖值预测糖尿病  

| 血糖 (x) | 糖尿病？ (y) |
|----------|------------|
| 67       | 0          |
| 103      | 1          |
| 114      | 1          |
| 72       | 0          |
| 116      | 1          |
| 65       | 0          |

📌 **模型目标**：
- **输入血糖值 (x)**，输出 **糖尿病概率**：
  - **接近 1.0** → 患病概率高 ✅
  - **接近 0.0** → 患病概率低 ❌  

---

## 2️⃣ 训练二元分类模型  

📌 **常见算法**：

✅ **逻辑回归 (Logistic Regression)** —— 通过 **S 形 (Sigmoid) 函数计算概率**。  
✅ **决策树 (Decision Tree)**、**随机森林 (Random Forest)** —— 通过决策路径分类。  
✅ **支持向量机 (SVM)** —— 通过超平面分隔不同类别。  
✅ **神经网络 (Neural Network)** —— 复杂数据分类。  

### 📌 逻辑回归模型的概率计算  

- 逻辑回归计算：
  $$ P(y = 1 | x) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 x)}} $$
  其中：
  - `P(y=1 | x)` 是预测糖尿病的概率
  - `β0` 和 `β1` 是模型参数
  - `e` 是自然对数的底数

📌 **示例**：
- 如果某患者的 **糖尿病概率 = 0.7**，则：
  - **患病概率 70%**
  - **未患病概率 30%**  

---

## 3️⃣ 评估二元分类模型  

📌 **测试数据集**：
| 血糖 (x) | 实际糖尿病 (y) | 预测糖尿病 (ŷ) |
|----------|--------------|--------------|
| 66       | 0            | 0            |
| 107      | 1            | 1            |
| 112      | 1            | 1            |
| 71       | 0            | 0            |
| 87       | 1            | 0            |
| 89       | 1            | 1            |

### 📊 **混淆矩阵 (Confusion Matrix)**

| 预测 \ 实际 | 0 (未患病) | 1 (患病) |
|-------------|----------|----------|
| **0 (预测未患病)** | 真阴性 (TN) | 假阴性 (FN) |
| **1 (预测患病)**  | 假阳性 (FP) | 真阳性 (TP) |

📌 **术语解释**：
- **真阳性 (TP)**：实际患病，预测也为患病 ✅
- **真阴性 (TN)**：实际未患病，预测也为未患病 ✅
- **假阳性 (FP)**：实际未患病，误判为患病 ❌
- **假阴性 (FN)**：实际患病，误判为未患病 ❌

---

## 4️⃣ 评估指标  

### 📌 1. **准确率 (Accuracy)**  

衡量模型的整体正确率：
$$ Accuracy = \frac{TN + TP}{TN + FN + FP + TP} $$

📌 **示例计算**：
$$ Accuracy = \frac{2 + 3}{2 + 1 + 0 + 3} = \frac{5}{6} = 0.83 $$  
📌 **问题**：
- 如果糖尿病患者只占 **11%**，但模型 **始终预测 "未患病"**，则准确率仍可高达 **89%**，但模型毫无意义 ❌。

---

### 📌 2. **召回率 (Recall)**  

衡量模型 **正确识别出实际患病者的比例**：
$$ Recall = \frac{TP}{TP + FN} $$

📌 **示例计算**：
$$ Recall = \frac{3}{3+1} = \frac{3}{4} = 0.75 $$  
📌 **解读**：
- **75% 的实际糖尿病患者被正确识别** ✅

---

### 📌 3. **精准率 (Precision)**  

衡量 **预测为糖尿病的人中，实际患病的比例**：
$$ Precision = \frac{TP}{TP + FP} $$

📌 **示例计算**：
$$ Precision = \frac{3}{3+0} = \frac{3}{3} = 1.0 $$  
📌 **解读**：
- **模型预测的所有糖尿病患者都是正确的 (100%)** ✅

---

### 📌 4. **F1 分数 (F1 Score)**  

F1 分数是 **精准率 (Precision) 和 召回率 (Recall) 的平衡指标**：
$$ F1 = \frac{2 \times Precision \times Recall}{Precision + Recall} $$

📌 **示例计算**：
$$ F1 = \frac{2 \times 1.0 \times 0.75}{1.0 + 0.75} = \frac{1.5}{1.75} = 0.86 $$  
📌 **解读**：
- **F1 分数越接近 1.0，模型整体表现越好** ✅

---

## 5️⃣ ROC 曲线与 AUC 指标  

📌 **ROC 曲线 (Receiver Operating Characteristic Curve)**：
- **展示不同阈值下的 真阳性率 (TPR) 和 假阳性率 (FPR)**。

📌 **AUC (曲线下面积)**：
- **AUC = 1.0** → 完美模型 🎯
- **AUC = 0.5** → 随机猜测 📉
- **AUC = 0.875** → **优秀模型** ✅

---

## 🎯 结语  

📌 **二元分类模型** 用于 **预测两种类别，如 "有病 or 无病"**。  
📌 **逻辑回归** 是常见的二元分类算法，使用 **S 形曲线计算概率**。  
📌 **评估分类模型时，不能只看准确率**，还要结合 **召回率、精准率、F1 分数、AUC** 等指标。  
📌 **ROC 曲线和 AUC 直观衡量模型分类能力**。  

🔗 **进一步学习分类模型**：
- [Scikit-learn 逻辑回归](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html)  
- [TensorFlow 分类教程](https://www.tensorflow.org/tutorials/keras/classification)  

📢 **欢迎 Star ⭐ 本仓库，获取更多 AI 资源！**
